<!DOCTYPE html>
<html lang="en">
<head>
    <!-- ... (same as before) ... -->
    <style>
        /* Existing styles */
        /* ... */

        /* Responsive Table */
        .table-responsive {
            overflow-x: auto;
        }

        /* Clickable rows */
        tr {
            cursor: pointer;
        }

        tr.selected {
            background-color: #d1e7dd;
        }

        /* Responsive Text */
        body {
            font-size: 1rem;
        }

        @media (max-width: 600px) {
            body {
                font-size: 0.9rem;
            }
            th, td {
                padding: 6px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Tennis Training Tracker</h1>
        <div class="table-responsive">
            <h2>Summary</h2>
            <table id="summary-table">
                <caption>Training Summary</caption>
                <!-- ... -->
            </table>
        </div>
        <div class="table-responsive">
            <h2>Details</h2>
            <table id="details-table" class="details">
                <caption>Session Details</caption>
                <!-- ... -->
            </table>
        </div>
    </div>

    <script>
        // Sanitize function
        function sanitize(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }

        // Fetch CSV with error handling
        async function fetchCSV(url) {
            try {
                const response = await fetch(url);
                if (!response.ok) throw new Error('Network response was not ok');
                const data = await response.text();
                const parsedData = Papa.parse(data, { header: true });
                if (parsedData.errors.length) throw new Error('Parsing error');
                return parsedData.data;
            } catch (error) {
                console.error('Error fetching or parsing data:', error);
                alert('There was an error loading the data.');
                return [];
            }
        }

        // Load summary with sanitized data and explicit columns
        async function loadSummary() {
            const summaryData = await fetchCSV('summary.csv');
            const summaryBody = document.getElementById('summary-body');
            const columns = ['Date', 'Hit % Baseline', '1st Serve %', '2nd Serve %', 'Duration in min', 'Calories Burned', 'Comment'];

            summaryData.forEach(row => {
                const tr = document.createElement('tr');
                tr.setAttribute('tabindex', '0');

                columns.forEach(col => {
                    const td = document.createElement('td');
                    td.innerHTML = sanitize(row[col]);
                    tr.appendChild(td);
                });

                tr.addEventListener('click', () => {
                    document.querySelectorAll('#summary-table tr').forEach(row => row.classList.remove('selected'));
                    tr.classList.add('selected');
                    loadDetails(row.Date);
                });

                tr.addEventListener('keydown', (e) => {
                    if (e.key === 'Enter') {
                        tr.click();
                    }
                });

                summaryBody.appendChild(tr);
            });
        }

        // Load details with sanitized data and explicit columns
        async function loadDetails(date) {
            const roundsData = await fetchCSV('rounds.csv');
            const detailsBody = document.getElementById('details-body');
            const detailsTable = document.getElementById('details-table');
            const columns = ['Round', 'Hit % Baseline', '1st Serve %', '2nd Serve %', 'Service Games Played'];
            detailsBody.innerHTML = '';

            const dateToMatch = date.trim();

            roundsData
                .filter(row => row.Date.trim() === dateToMatch)
                .forEach(row => {
                    const tr = document.createElement('tr');
                    columns.forEach(col => {
                        const td = document.createElement('td');
                        td.innerHTML = sanitize(row[col]);
                        tr.appendChild(td);
                    });
                    detailsBody.appendChild(tr);
                });

            detailsTable.style.display = 'table';
        }

        // Initial load
        window.onload = function() {
            loadSummary();
        };
    </script>
    <!-- PapaParse script -->
</body>
</html>
